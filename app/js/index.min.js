document.addEventListener("DOMContentLoaded",(()=>{const t=document.getElementById("fifteen");Array.from({length:16},((t,e)=>e+1)).forEach((e=>{const n=document.createElement("button");n.className="item",n.setAttribute("data-matrix-id",e);const r=document.createElement("span");r.className="border",r.textContent=e,n.appendChild(r),t.appendChild(n)}));const e=Array.from(t.querySelectorAll(".item"));if(16!==e.length)throw new Error("Должно быть ровно 16 items in HTML");e[15].style.display="none";let n=r(e.map((t=>Number(t.dataset.matrixId))));o(n),document.getElementById("shuffleButton").addEventListener("click",(()=>{const t=n.flat().map((t=>({value:t,sort:Math.random()}))).sort(((t,e)=>t.sort-e.sort)).map((({value:t})=>t));n=r(t),o(n)}));function r(t){const e=[[],[],[],[]];let n=0,r=0;for(let o=0;o<t.length;o++)r>=4&&(n++,r=0),e[n][r]=t[o],r++;return e}function o(t){for(let n=0;n<t.length;n++)for(let r=0;r<t[n].length;r++){const o=t[n][r];s(e[o-1],r,n)}}function s(t,e,n){t.style.transform=`translate3D(${100*e}%, ${100*n}%,0)`}function a(t,e){for(let n=0;n<e.length;n++)for(let r=0;r<e[n].length;r++)if(e[n][r]===t)return{x:r,y:n};return null}function l(e,n,r){const o=r[e.y][e.x];r[e.y][e.x]=r[n.y][n.x],r[n.y][n.x]=o,function(t){const e=t.flat();for(let t=0;t<c.length;t++)if(e[t]!==c[t])return!1;return!0}(r)&&setTimeout((()=>{t.classList.add(i),setTimeout((()=>{t.classList.remove(i)}),1e3)}),200)}t.addEventListener("click",(t=>{const e=t.target.closest("button");if(!e)return;const r=a(Number(e.dataset.matrixId),n),s=a(16,n);(function(t,e){const n=Math.abs(t.x-e.x),r=Math.abs(t.y-e.y);return!(1!==n&&1!==r||t.x!==e.x&&t.y!==e.y)})(r,s)&&(l(s,r,n),o(n))})),window.addEventListener("keydown",(t=>{if(!t.key.includes("Arrow"))return;const e=a(16,n),r={x:e.x,y:e.y},s=n.length;switch(t.key.split("Arrow")[1].toLowerCase()){case"up":r.y+=1;break;case"down":r.y-=1;break;case"left":r.x+=1;break;case"right":r.x-=1}r.y>=s||r.y<0||r.x>=s||r.x<0||(l(e,r,n),o(n))}));const c=new Array(16).fill(0).map(((t,e)=>e+1));const i="fifteenWon"}));